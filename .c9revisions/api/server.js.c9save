{"ts":1381597014282,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var http = require('http'),\n    express = require('express'),\n    aircraft = require('./models/aircraft.js'),\n    repo = require('./repo.js'),\n    app = express();\n    \nmodule.exports = http.createServer(app);\n\napp.use(express.bodyParser());\napp.use(express.errorHandler({ dumpExceptions: true, showStack: true }));\napp.set('jsonp callback', true);\n\napp.get('/aircraft', function(req, res) {\n    console.log('Received request for all aircraft');\n    res.header('Content-Type', 'application/json');\n    res.header('Charset', 'utf-8');\n    repo.load(null, function(result) {\n        result ? res.send(result)\n           : res.send({});\n    });\n});\n\napp.get('/aircraft/:id', function(req, res) {\n    console.log('Received request for: ' + JSON.stringify(req.params.id));\n    res.header('Content-Type', 'application/json');\n    res.header('Charset', 'utf-8');\n    repo.load(req.params.id, function(result) {\n        result ? res.send(result)\n           : res.send({});\n    });\n});\n\napp.post('/aircraft', function(req, res) {\n    var item = new aircraft({\n        make: req.body.make,\n        model: req.body.model,\n        nnumber: req.body.nnumber\n    });\n\n    repo.save(item, function(result) {\n        res.header('Content-Type', 'application/json');\n        res.header('Charset', 'utf-8');\n        res.send(result, 201);\n    });\n});\n\napp.put('/aircraft/:id', function(req, res) {\n    repo.load(req.params.id, function(item) {\n        item.make = req.body.make;\n        item.model = req.body.model;\n        item.nnumber = req.body.nnumber;\n\n        repo.save(item, function(result) {\n            res.header('Content-Type', 'application/json');\n            res.header('Charset', 'utf-8');\n            res.send(result, 200);\n        });\n    });\n});\n\napp.delete('/aircraft/:id', function(req, res) {\n    repo.load(req.params.id, function(item) {\n        repo.remove(item, function () {\n            res.send(200);\n        });\n    });\n});\n\n// Test data\n//console.log('Adding new aircraft.');\n//repo.save(new aircraft({ make: 'Beechcraft', model: 'Bonanza', nnumber: 'N12345'}));\n\nconsole.log('Loaded API Server');"]],"start1":0,"start2":0,"length1":0,"length2":2106}]],"length":2106}
